import{r as i,bn as e,bo as Se,bp as je,bq as Ce,br as ye,bs as we,bt as ve,bu as ae,bv as be,bw as Te,bx as Ne,by as ke,bz as Le,bA as Ae,bB as Ie,bC as Me,bD as Pe}from"./vendor-c238243a.js";import{S as Re,E as qe,a as Ee,b as Be,D as ze,c as Ge}from"./fluentui-icons-58716126.js";import{S as _,P as $e,T as oe,a as Oe,B as U,b as Ve,c as Fe,D as He,d as Qe,e as De,C as te,f as We,g as Ue}from"./fluentui-react-7e1805fb.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))h(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&h(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(n){if(n.ep)return;n.ep=!0;const c=r(n);fetch(n.href,c)}})();var y=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(y||{}),re=(t=>(t.Vector="Vector Search",t.Semantic="Semantic Ranker",t.GraphRAG="GraphRAG",t))(re||{});const ie=i.createContext(void 0),Ke=({children:t})=>{const[s,r]=i.useState(re.Vector);return e.jsx(ie.Provider,{value:{sharedState:s,setSharedState:r},children:t})};const Je="_layout_pmgip_1",Xe="_header_pmgip_7",Ye="_headerContainer_pmgip_12",Ze="_headerTitleContainer_pmgip_20",et="_radioContainer_pmgip_28",tt="_radioInput_pmgip_40",st="_headerLogo_pmgip_49",nt="_headerTitle_pmgip_20",at="_headerRightText_pmgip_58",b={layout:Je,header:Xe,headerContainer:Ye,headerTitleContainer:Ze,radioContainer:et,radioInput:tt,headerLogo:st,headerTitle:nt,headerRightText:at},ot=()=>{const[t,s]=i.useState("Vector Search"),r=i.useContext(ie);if(!r)throw new Error("Layout component must be used within an AppStateProvider");const{sharedState:h,setSharedState:n}=r,c=l=>{s(l.target.value),console.log("handleModeChange: "+l.target.value.toString()),n(p=>l.target.value)};return e.jsxs("div",{className:b.layout,children:[e.jsx("header",{className:b.header,role:"banner",children:e.jsxs("div",{className:b.headerContainer,children:[e.jsx(Se,{to:"/",className:b.headerTitleContainer,children:e.jsx("h3",{className:b.headerTitle,children:"Legal Research Assistant"})}),e.jsxs("div",{className:b.radioContainer,children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",value:"Vector Search",checked:t==="Vector Search",onChange:c,className:b.radioInput}),"Vector Search"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",value:"Semantic Ranker",checked:t==="Semantic Ranker",onChange:c,className:b.radioInput}),"Semantic Ranker"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",value:"GraphRAG",checked:t==="GraphRAG",onChange:c,className:b.radioInput}),"GraphRAG + Semantic Ranker"]})]}),e.jsx("h4",{className:b.headerRightText,children:"Demo: GraphRAG on PostgreSQL"})]})}),e.jsx(je,{})]})},rt="_container_ggo0d_1",it="_chatRoot_ggo0d_8",ct="_chatContainer_ggo0d_13",lt="_chatEmptyState_ggo0d_21",dt="_chatEmptyStateTitle_ggo0d_31",ht="_chatEmptyStateSubtitle_ggo0d_38",ut="_chatMessageStream_ggo0d_54",pt="_chatMessageGpt_ggo0d_66",mt="_chatMessageGptMinWidth_ggo0d_73",gt="_chatInput_ggo0d_78",_t="_chatAnalysisPanel_ggo0d_91",xt="_chatSettingsSeparator_ggo0d_99",ft="_loadingLogo_ggo0d_105",St="_commandsContainer_ggo0d_109",jt="_commandButton_ggo0d_114",d={container:rt,chatRoot:it,chatContainer:ct,chatEmptyState:lt,chatEmptyStateTitle:dt,chatEmptyStateSubtitle:ht,chatMessageStream:ut,chatMessageGpt:pt,chatMessageGptMinWidth:mt,chatInput:gt,chatAnalysisPanel:_t,chatSettingsSeparator:xt,loadingLogo:ft,commandsContainer:St,commandButton:jt},Ct="_answerContainer_qz1fg_1",yt="_answerLogo_qz1fg_11",wt="_answerText_qz1fg_15",vt="_selected_qz1fg_34",bt="_referenceMetadata_qz1fg_38",Tt="_citationLearnMore_qz1fg_43",Nt="_citation_qz1fg_43",kt="_followupQuestionsList_qz1fg_65",Lt="_followupQuestionLearnMore_qz1fg_69",At="_followupQuestion_qz1fg_65",It="_supContainer_qz1fg_88",Mt="_retryButton_qz1fg_117",Pt="_loadingdots_qz1fg_139",Rt="_loading_qz1fg_139",g={answerContainer:Ct,answerLogo:yt,answerText:wt,selected:vt,referenceMetadata:bt,citationLearnMore:Tt,citation:Nt,followupQuestionsList:kt,followupQuestionLearnMore:Lt,followupQuestion:At,supContainer:It,retryButton:Mt,loadingdots:Pt,loading:Rt};function qt(t,s,r){const h=[];let n=t.trim();if(s){let p=n.length;for(let m=n.length-1;m>=0&&n[m]!=="]";m--)if(n[m]==="["){p=m;break}n=n.substring(0,p)}return{answerHtml:n.split(/\[([^\]]+)\]/g).map((p,j)=>{if(j%2===0)return p;{let m;return h.indexOf(p)!==-1?m=h.indexOf(p)+1:(h.push(p),m=h.length),Ce(e.jsx("a",{className:"supContainer",title:p,children:e.jsx("sup",{children:m})}))}}).join(""),citations:h}}const ce=()=>e.jsx(Re,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),se=({answer:t,isSelected:s,isStreaming:r,onCitationClicked:h,onThoughtProcessClicked:n,onSupportingContentClicked:c,onFollowupQuestionClicked:l,showFollowupQuestions:p})=>{const j=t.context.followup_questions,m=t.message.content,u=i.useMemo(()=>qt(m,r),[t]),T=ye.sanitize(u.answerHtml);return e.jsxs(_,{className:`${g.answerContainer} ${s&&g.selected}`,verticalAlign:"space-between",children:[e.jsx(_.Item,{children:e.jsxs(_,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(ce,{}),!1]})}),e.jsx(_.Item,{grow:!0,children:e.jsx("div",{className:g.answerText,dangerouslySetInnerHTML:{__html:T}})}),!!u.citations.length&&e.jsx(_.Item,{children:e.jsxs(_,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:g.citationLearnMore,children:"References:"}),e.jsx("ol",{children:u.citations.map((C,L)=>{const x=t.context.data_points[C];return x?e.jsxs("li",{children:[e.jsx("h4",{children:x.id}),e.jsxs("p",{className:g.referenceMetadata,children:["Court: ",x.data.court.name]}),e.jsxs("p",{className:g.referenceMetadata,children:["Decision Date: ",x.data.decision_date]}),e.jsx("p",{children:x.data.name})]},C):null})})]})}),!!j?.length&&p&&l&&e.jsx(_.Item,{children:e.jsxs(_,{horizontal:!0,wrap:!0,className:`${u.citations.length?g.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:g.followupQuestionLearnMore,children:"Follow-up questions:"}),j.map((C,L)=>e.jsx("a",{className:g.followupQuestion,title:C,onClick:()=>l(C),children:`${C}`},L))]})})]})},Et=()=>{const t=we({from:{opacity:0},to:{opacity:1}});return e.jsx(ve.div,{style:{...t},children:e.jsxs(_,{className:g.answerContainer,verticalAlign:"space-between",children:[e.jsx(ce,{}),e.jsx(_.Item,{grow:!0,children:e.jsxs("p",{className:g.answerText,children:["Generating answer",e.jsx("span",{className:g.loadingdots})]})})]})})},Bt=({error:t,onRetry:s})=>e.jsxs(_,{className:g.answerContainer,verticalAlign:"space-between",children:[e.jsx(qe,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(_.Item,{grow:!0,children:e.jsx("p",{className:g.answerText,children:t})}),e.jsx($e,{className:g.retryButton,onClick:s,text:"Retry"})]}),zt="_questionInputContainer_hiipw_1",Gt="_questionInputTextArea_hiipw_12",$t="_questionInputButtonsContainer_hiipw_17",D={questionInputContainer:zt,questionInputTextArea:Gt,questionInputButtonsContainer:$t},Ot=({onSend:t,disabled:s,placeholder:r,clearOnSend:h,initQuestion:n})=>{const[c,l]=i.useState("");i.useEffect(()=>{n&&l(n)},[n]);const p=()=>{s||!c.trim()||(t(c),h&&l(""))},j=u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),p())},m=(u,T)=>{T?T.length<=1e3&&l(T):l("")};return e.jsxs(_,{horizontal:!0,className:D.questionInputContainer,children:[e.jsx(oe,{className:D.questionInputTextArea,placeholder:r,multiline:!0,resizable:!1,borderless:!0,value:c,onChange:m,onKeyDown:j}),e.jsx("div",{className:D.questionInputButtonsContainer,children:e.jsx(Oe,{content:"Ask question button",relationship:"label",children:e.jsx(U,{size:"large",icon:e.jsx(Ee,{primaryFill:"rgba(115, 118, 225, 1)"}),onClick:p})})})]})},Vt="_examplesNavList_epc38_1",Ft="_example_epc38_1",Ht="_exampleText_epc38_29",W={examplesNavList:Vt,example:Ft,exampleText:Ht},Qt=({text:t,value:s,onClick:r})=>e.jsx("div",{className:W.example,onClick:()=>r(s),children:e.jsx("p",{className:W.exampleText,children:t})}),Dt=["Water leaking into the apartment from the floor above. What are the prominent legal precedents in Washington on this problem?","When the landlord is sued in court for leaking pipes, how many times did it result in a favorable decision for the lessee?"],Wt=({onExampleClicked:t})=>e.jsx("ul",{className:W.examplesNavList,children:Dt.map((s,r)=>e.jsx("li",{children:e.jsx(Qt,{text:s,value:s,onClick:t})},r))}),Ut="_container_1p3pb_1",Kt="_message_1p3pb_9",ne={container:Ut,message:Kt},$=({message:t})=>e.jsx("div",{className:ne.container,children:e.jsx("div",{className:ne.message,children:t})}),Jt="_thoughtProcess_1ooqd_1",Xt="_tList_1ooqd_8",Yt="_tListItem_1ooqd_14",Zt="_tStep_1ooqd_40",es="_tCodeBlock_1ooqd_47",ts="_tProp_1ooqd_51",ss="_citationImg_1ooqd_60",E={thoughtProcess:Jt,tList:Xt,tListItem:Yt,tStep:Zt,tCodeBlock:es,tProp:ts,citationImg:ss};var k=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(k||{});ae.registerLanguage("json",be);const ns=({thoughts:t})=>e.jsx("ul",{className:E.tList,children:t.map((s,r)=>e.jsxs("li",{className:E.tListItem,children:[e.jsx("div",{className:E.tStep,children:s.title}),e.jsx(_,{horizontal:!0,tokens:{childrenGap:5},children:s.props&&(Object.keys(s.props)||[]).map(h=>e.jsxs("span",{className:E.tProp,children:[h,": ",JSON.stringify(s.props?.[h])]}))}),Array.isArray(s.description)?e.jsx(ae,{language:"json",wrapLongLines:!0,className:E.tCodeBlock,style:Te,children:JSON.stringify(s.description,null,2)}):e.jsx("div",{children:s.description})]},r))});const as={disabled:!0,style:{color:"grey"}},os=({answer:t,activeTab:s,activeCitation:r,citationHeight:h,className:n,onActiveTabChanged:c})=>{const l=!t.context.thoughts;t.context.data_points;const[p,j]=i.useState(""),m=async()=>{if(r){const u=r.indexOf("#")?r.split("#")[1]:"",C=await(await fetch(r,{method:"GET"})).blob();let L=URL.createObjectURL(C);u&&(L+="#"+u),j(L)}};return i.useEffect(()=>{m()},[]),e.jsx(Ve,{className:n,selectedKey:s,onLinkClick:u=>u&&c(u.props.itemKey),children:e.jsx(Fe,{itemKey:k.ThoughtProcessTab,headerText:"Thought process",headerButtonProps:l?as:void 0,children:e.jsx(ns,{thoughts:t.context.thoughts||[]})})})},rs="_container_cfwv2_1",is={container:rs},cs=({className:t,onClick:s})=>e.jsx("div",{className:`${is.container} ${t??""}`,children:e.jsx(U,{icon:e.jsx(Be,{}),onClick:s,children:"Developer settings"})}),ls="_container_cfwv2_1",ds={container:ls},hs=({className:t,disabled:s,onClick:r})=>e.jsx("div",{className:`${ds.container} ${t??""}`,children:e.jsx(U,{icon:e.jsx(ze,{}),disabled:s,onClick:r,children:"Clear chat"})}),us="_container_1pzrp_1",ps={container:us},ms=({updateRetrievalMode:t})=>{const[s,r]=i.useState(y.Hybrid),h=(n,c)=>{r(c?.data||y.Hybrid),t(c?.data||y.Hybrid)};return e.jsx(_,{className:ps.container,tokens:{childrenGap:10},children:e.jsx(He,{label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:s==y.Hybrid,data:y.Hybrid},{key:"vectors",text:"Vectors",selected:s==y.Vectors,data:y.Vectors},{key:"text",text:"Text",selected:s==y.Text,data:y.Text}],required:!0,onChange:h})})},gs=()=>{const[t,s]=i.useState(!1),[r,h]=i.useState(""),[n,c]=i.useState(.3),[l,p]=i.useState(3),[j,m]=i.useState(y.Hybrid),[u,T]=i.useState(!0),[C,L]=i.useState(!0),x=i.useRef(""),O=i.useRef(null),[B,z]=i.useState(!1),[K,V]=i.useState(!1),[G,F]=i.useState(),[J,H]=i.useState(),[M,A]=i.useState(void 0),[P,X]=i.useState(0),[w,Q]=i.useState([]),[Y,Z]=i.useState([]),le=async(a,o,f)=>{let I="",v={context:{data_points:{},followup_questions:null,thoughts:[]},message:{content:"",role:"assistant"}};const N=S=>new Promise(xe=>{setTimeout(()=>{I+=S;const fe={...v,message:{content:I,role:v.message.role}};Z([...o,[a,fe]]),xe(null)},33)});try{V(!0);for await(const S of f)S.context&&(v.context={...v.context,...S.context}),S.delta&&S.delta.role&&(v.message.role=S.delta.role),S.delta&&S.delta.content&&(z(!1),await N(S.delta.content))}finally{V(!1)}return v.message.content=I,v},R=async a=>{x.current=a,G&&F(void 0),z(!0),H(void 0),A(void 0);try{const f=[...w.flatMap(N=>[{content:N[0],role:"user"},{content:N[1].message.content,role:"assistant"}]),{content:a,role:"user"}],I={context:{overrides:{use_advanced_flow:u,top:l,retrieval_mode:j,prompt_template:r.length===0?void 0:r,temperature:n}},sessionState:w.length?w[w.length-1][1].sessionState:null},v=new Ne("/chat");if(C){const N=await v.getStreamedCompletion(f,I),S=await le(a,w,N);Q([...w,[a,S]])}else{const N=await v.getCompletion(f,I);Q([...w,[a,N]])}}catch(o){F(o)}finally{z(!1)}},de=()=>{x.current="",G&&F(void 0),H(void 0),A(void 0),Q([]),Z([]),z(!1),V(!1)};i.useEffect(()=>O.current?.scrollIntoView({behavior:"smooth"}),[B]),i.useEffect(()=>O.current?.scrollIntoView({behavior:"auto"}),[Y]);const he=(a,o)=>{h(o||"")},ue=(a,o,f)=>{c(a)},pe=(a,o)=>{p(parseInt(o||"3"))},me=(a,o)=>{T(!!o)},ge=(a,o)=>{L(!!o)},_e=a=>{R(a)},ee=(a,o)=>{J===a&&M===k.CitationTab&&P===o?A(void 0):(H(a),A(k.CitationTab)),X(o)},q=(a,o)=>{A(M===a&&P===o?void 0:a),X(o)};return e.jsxs("div",{className:d.container,children:[e.jsxs("div",{className:d.commandsContainer,children:[e.jsx(hs,{className:d.commandButton,onClick:de,disabled:!x.current||B}),e.jsx(cs,{className:d.commandButton,onClick:()=>s(!t)})]}),e.jsxs("div",{className:d.chatRoot,children:[e.jsxs("div",{className:d.chatContainer,children:[x.current?e.jsxs("div",{className:d.chatMessageStream,children:[K&&Y.map((a,o)=>e.jsxs("div",{children:[e.jsx($,{message:a[0]}),e.jsx("div",{className:d.chatMessageGpt,children:e.jsx(se,{isStreaming:!0,answer:a[1],isSelected:!1,onCitationClicked:f=>ee(f,o),onThoughtProcessClicked:()=>q(k.ThoughtProcessTab,o),onSupportingContentClicked:()=>q(k.SupportingContentTab,o),onFollowupQuestionClicked:f=>R(f)},o)})]},o)),!K&&w.map((a,o)=>e.jsxs("div",{children:[e.jsx($,{message:a[0]}),e.jsx("div",{className:d.chatMessageGpt,children:e.jsx(se,{isStreaming:!1,answer:a[1],isSelected:P===o&&M!==void 0,onCitationClicked:f=>ee(f,o),onThoughtProcessClicked:()=>q(k.ThoughtProcessTab,o),onSupportingContentClicked:()=>q(k.SupportingContentTab,o),onFollowupQuestionClicked:f=>R(f)},o)})]},o)),B&&e.jsxs(e.Fragment,{children:[e.jsx($,{message:x.current}),e.jsx("div",{className:d.chatMessageGptMinWidth,children:e.jsx(Et,{})})]}),G?e.jsxs(e.Fragment,{children:[e.jsx($,{message:x.current}),e.jsx("div",{className:d.chatMessageGptMinWidth,children:e.jsx(Bt,{error:G.toString(),onRetry:()=>R(x.current)})})]}):null,e.jsx("div",{ref:O})]}):e.jsxs("div",{className:d.chatEmptyState,children:[e.jsx(Ge,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:d.chatEmptyStateTitle,children:"Product chat"}),e.jsx("h2",{className:d.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e.jsx(Wt,{onExampleClicked:_e})]}),e.jsx("div",{className:d.chatInput,children:e.jsx(Ot,{clearOnSend:!0,placeholder:"Type a new question",disabled:B,onSend:a=>R(a)})})]}),w.length>0&&M&&e.jsx(os,{className:d.chatAnalysisPanel,activeCitation:J,onActiveTabChanged:a=>q(a,P),citationHeight:"810px",answer:w[P][1],activeTab:M}),e.jsxs(Qe,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>s(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(De,{onClick:()=>s(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(te,{className:d.chatSettingsSeparator,checked:u,label:"Use advanced flow with query rewriting and filter formulation. Not compatible with Ollama models.",onChange:me}),e.jsx("h3",{children:"Settings for database search:"}),e.jsx(We,{className:d.chatSettingsSeparator,label:"Retrieve this many matching rows:",min:1,max:50,defaultValue:l.toString(),onChange:pe}),e.jsx(ms,{updateRetrievalMode:a=>m(a)}),e.jsx("h3",{children:"Settings for final chat completion:"}),e.jsx(oe,{className:d.chatSettingsSeparator,defaultValue:r,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:he}),e.jsx(Ue,{className:d.chatSettingsSeparator,label:"Temperature",min:0,max:1,step:.1,defaultValue:n,onChange:ue,showValue:!0,snapToStep:!0}),e.jsx(te,{className:d.chatSettingsSeparator,checked:C,label:"Stream chat completion responses",onChange:ge})]})]})]})};var _s=e.jsx(gs,{});ke();const xs=Le([{path:"/",element:e.jsx(Ke,{children:e.jsx(ot,{})}),children:[{index:!0,element:_s},{path:"*",lazy:()=>Pe(()=>import("./NoPage-42b78e1a.js"),["assets/NoPage-42b78e1a.js","assets/vendor-c238243a.js"])}]}]);Ae.createRoot(document.getElementById("root")).render(e.jsx(Ie.StrictMode,{children:e.jsx(Me,{router:xs})}));
//# sourceMappingURL=index-49deb22e.js.map
